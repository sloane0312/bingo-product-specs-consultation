# Excel 输出模板

本文档定义控标参数比对结果 Excel 文件的结构和格式。

## 文件结构

Excel 文件包含 5 个工作表（Sheet）：

```
├── Sheet 1: 比对总览
├── Sheet 2: 满足参数明细
├── Sheet 3: 不满足参数明细
├── Sheet 4: 待复核参数
└── Sheet 5: 原始数据
```

---

## Sheet 1: 比对总览

### 表头区域（A1:H6）

| 单元格 | 内容 | 格式 |
|--------|------|------|
| A1:H1 | 【品高产品控标参数比对报告】 | 合并居中，加粗，字号16 |
| A3 | 产品名称： | 加粗 |
| B3 | {product_name} | - |
| A4 | 项目名称： | 加粗 |
| B4 | {project_name} | - |
| A5 | 比对日期： | 加粗 |
| B5 | {date} | 日期格式 |
| A6 | 知识库版本： | 加粗 |
| B6 | {knowledge_version} | - |

### 统计区域（A8:D12）

| A | B | C | D |
|---|---|---|---|
| **统计项** | **数量** | **占比** | **状态** |
| 咨询参数总数 | {total} | 100% | - |
| 满足参数 | {match} | {match_pct}% | ✅ |
| 不满足参数 | {unmatch} | {unmatch_pct}% | ❌ |
| 待复核参数 | {review} | {review_pct}% | ⚠️ |

### 结论区域（A14:H20）

| 单元格 | 内容 |
|--------|------|
| A14 | 【比对结论】 |
| A15:H20 | {conclusion_text} |

---

## Sheet 2: 满足参数明细

### 列定义

| 列 | 字段名 | 宽度 | 说明 |
|----|-------|------|------|
| A | 序号 | 5 | 自增序号 |
| B | 参数分类 | 12 | 功能/技术/性能/安全 |
| C | 参数名称 | 25 | 具体参数项 |
| D | 咨询要求 | 30 | 咨询者提供的参数值 |
| E | 标品规格 | 30 | 标准产品对应参数值 |
| F | 比对结果 | 10 | 固定为"满足" |
| G | 符合说明 | 50 | 具体如何满足的描述 |

### 示例数据

| 序号 | 参数分类 | 参数名称 | 咨询要求 | 标品规格 | 比对结果 | 符合说明 |
|------|---------|---------|---------|---------|---------|---------|
| 1 | 技术参数 | Kubernetes版本 | 1.28及以上 | 1.26-1.30 | 满足 | 标品支持1.26-1.30版本，包含并超出1.28要求 |
| 2 | 技术参数 | 集群节点数 | ≥1000节点 | 5000节点 | 满足 | 标品支持5000节点，超出要求4倍 |
| 3 | 功能参数 | 多租户隔离 | 支持网络隔离 | 网络级+命名空间级 | 满足 | 标品支持两级隔离，满足网络隔离要求 |
| 4 | 功能参数 | 图形化界面 | 需要 | Web控制台 | 满足 | 标品提供完整Web管理控制台 |
| 5 | 技术参数 | CPU架构 | x86和ARM | 双架构支持 | 满足 | 标品支持x86_64和ARM64混合部署 |

---

## Sheet 3: 不满足参数明细

### 列定义

| 列 | 字段名 | 宽度 | 说明 |
|----|-------|------|------|
| A | 序号 | 5 | 自增序号 |
| B | 参数分类 | 12 | 功能/技术/性能/安全 |
| C | 参数名称 | 25 | 具体参数项 |
| D | 咨询要求 | 30 | 咨询者提供的参数值 |
| E | 标品规格 | 30 | 标准产品对应参数值 |
| F | 比对结果 | 10 | 固定为"不满足" |
| G | 差异分析 | 60 | 具体哪里不符合 |
| H | 建议措施 | 50 | 如何解决或替代方案 |

### 示例数据

| 序号 | 参数分类 | 参数名称 | 咨询要求 | 标品规格 | 比对结果 | 差异分析 | 建议措施 |
|------|---------|---------|---------|---------|---------|---------|---------|
| 1 | 功能参数 | GPU虚拟化 | 支持GPU资源池化和虚拟化 | GPU直通模式，虚拟化Beta | 不满足 | 【不符合点】当前v3.2版本GPU虚拟化为Beta状态，不建议生产使用。【差距】缺少生产级GPU池化能力。 | 1）等待v3.3版本正式支持（预计Q2）；2）先用GPU直通模式过渡；3）评估NVIDIA vGPU方案 |
| 2 | 性能参数 | 存储IOPS | ≥100万IOPS | 80万IOPS | 不满足 | 【不符合点】标品单卷最大80万IOPS，低于要求20万。【差距】20%性能缺口。 | 1）增加存储节点实现聚合；2）升级企业级NVMe SSD；3）采用分布式存储方案 |

### 格式要求

- 不满足行使用浅红色背景（#FFE6E6）
- 差异分析列使用自动换行
- 建议措施使用编号列表格式

---

## Sheet 4: 待复核参数

### 列定义

| 列 | 字段名 | 宽度 | 说明 |
|----|-------|------|------|
| A | 序号 | 5 | 自增序号 |
| B | 参数分类 | 12 | 功能/技术/性能/安全 |
| C | 参数名称 | 25 | 具体参数项 |
| D | 咨询要求 | 30 | 咨询者提供的参数值 |
| E | 标品描述 | 30 | 标品相关描述 |
| F | 复核原因 | 50 | 为何需要人工确认 |
| G | 复核建议 | 40 | 建议的确认方式 |

### 示例数据

| 序号 | 参数分类 | 参数名称 | 咨询要求 | 标品描述 | 复核原因 | 复核建议 |
|------|---------|---------|---------|---------|---------|---------|
| 1 | 安全参数 | 等保认证 | 等保三级 | 支持等保合规部署 | 知识库记录支持等保部署，但未明确已取得等保三级证书 | 联系商务确认证书状态 |
| 2 | 功能参数 | 自定义调度策略 | 支持自定义调度算法 | 支持调度策略配置 | 咨询要求为"自定义算法"，标品描述为"策略配置"，需确认是否包含自定义算法能力 | 咨询研发确认具体能力边界 |

### 格式要求

- 待复核行使用浅黄色背景（#FFFDE6）

---

## Sheet 5: 原始数据

### 区域划分

**A1:E区域 - 咨询参数原文**

| 列 | 内容 |
|----|------|
| A | 序号 |
| B | 参数原文 |
| C | 提取的参数名 |
| D | 提取的参数值 |
| E | 来源位置 |

**G1:K区域 - 标品参数原文**

| 列 | 内容 |
|----|------|
| G | 序号 |
| H | 参数名称 |
| I | 参数值 |
| J | 来源文件 |
| K | 文件行号 |

---

## 格式规范

### 颜色编码

| 状态 | 背景色 | 色值 |
|------|-------|------|
| 满足 | 浅绿色 | #E6FFE6 |
| 不满足 | 浅红色 | #FFE6E6 |
| 待复核 | 浅黄色 | #FFFDE6 |
| 表头 | 深蓝色 | #4472C4 |
| 表头文字 | 白色 | #FFFFFF |

### 字体规范

| 区域 | 字体 | 字号 |
|------|------|------|
| 标题 | 微软雅黑 | 16 |
| 表头 | 微软雅黑 | 11，加粗 |
| 正文 | 微软雅黑 | 10 |
| 备注 | 微软雅黑 | 9，灰色 |

### 边框规范

- 所有数据区域使用细边框
- 表头使用下边框加粗
- 合计行使用上边框加粗

---

## 创建命令

使用 xlsx skill 创建表格：

```
/xlsx create --template comparison-report --data comparison_data.json --output "{产品名}_控标参数比对_{项目名}_{日期}.xlsx"
```

或手动创建：

```python
# Python 示例（使用 openpyxl）
from openpyxl import Workbook
from openpyxl.styles import Font, Fill, PatternFill, Alignment

wb = Workbook()

# 创建各 Sheet
ws_summary = wb.active
ws_summary.title = "比对总览"
ws_match = wb.create_sheet("满足参数明细")
ws_unmatch = wb.create_sheet("不满足参数明细")
ws_review = wb.create_sheet("待复核参数")
ws_raw = wb.create_sheet("原始数据")

# ... 填充数据和设置格式 ...

wb.save("比对结果.xlsx")
```
